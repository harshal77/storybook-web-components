(function(){var m,t,w,y,u,z={}.hasOwnProperty,A=[].slice;this.OverlappingMarkerSpiderfier=function(){function r(a,d){var b,f,e;for(b in this.map=a,null==d&&(d={}),null==this.constructor.N&&(this.constructor.N=!0,h=google.maps,l=h.event,p=h.MapTypeId,c.keepSpiderfied=!1,c.ignoreMapClick=!1,c.markersWontHide=!1,c.markersWontMove=!1,c.basicFormatEvents=!1,c.nearbyDistance=20,c.circleSpiralSwitchover=9,c.circleFootSeparation=23,c.circleStartAngle=x/12,c.spiralFootSeparation=26,c.spiralLengthStart=11,c.spiralLengthFactor=4,c.spiderfiedZIndex=h.Marker.MAX_ZINDEX+2e4,c.highlightedLegZIndex=h.Marker.MAX_ZINDEX+1e4,c.usualLegZIndex=h.Marker.MAX_ZINDEX+1,c.legWeight=1.5,c.legColors={usual:{},highlighted:{}},e=c.legColors.usual,f=c.legColors.highlighted,e[p.HYBRID]=e[p.SATELLITE]="#fff",f[p.HYBRID]=f[p.SATELLITE]="#f00",e[p.TERRAIN]=e[p.ROADMAP]="#444",f[p.TERRAIN]=f[p.ROADMAP]="#f00",this.constructor.j=function(a){return this.setMap(a)},this.constructor.j.prototype=new h.OverlayView,this.constructor.j.prototype.draw=function(){}),d)z.call(d,b)&&(f=d[b],this[b]=f);this.g=new this.constructor.j(this.map),this.C(),this.c={},this.B=this.l=null,this.addListener("click",(function(a,b){return l.trigger(a,"spider_click",b)})),this.addListener("format",(function(a,b){return l.trigger(a,"spider_format",b)})),this.ignoreMapClick||l.addListener(this.map,"click",function(a){return function(){return a.unspiderfy()}}(this)),l.addListener(this.map,"maptypeid_changed",function(a){return function(){return a.unspiderfy()}}(this)),l.addListener(this.map,"zoom_changed",function(a){return function(){if(a.unspiderfy(),!a.basicFormatEvents)return a.h()}}(this))}var l,h,m,v,p,c,t,x;for(m=0,v=(t=[r,c=r.prototype]).length;m<v;m++)t[m].VERSION="1.0.3";return x=2*Math.PI,h=l=p=null,r.markerStatus={SPIDERFIED:"SPIDERFIED",SPIDERFIABLE:"SPIDERFIABLE",UNSPIDERFIABLE:"UNSPIDERFIABLE",UNSPIDERFIED:"UNSPIDERFIED"},c.C=function(){this.a=[],this.s=[]},c.addMarker=function(a,d){return a.setMap(this.map),this.trackMarker(a,d)},c.trackMarker=function(a,d){var b;return null!=a._oms||(a._oms=!0,b=[l.addListener(a,"click",function(b){return function(d){return b.V(a,d)}}(this))],this.markersWontHide||b.push(l.addListener(a,"visible_changed",function(b){return function(){return b.D(a,!1)}}(this))),this.markersWontMove||b.push(l.addListener(a,"position_changed",function(b){return function(){return b.D(a,!0)}}(this))),null!=d&&b.push(l.addListener(a,"spider_click",d)),this.s.push(b),this.a.push(a),this.basicFormatEvents?this.trigger("format",a,this.constructor.markerStatus.UNSPIDERFIED):(this.trigger("format",a,this.constructor.markerStatus.UNSPIDERFIABLE),this.h())),this},c.D=function(a,d){if(!this.J&&!this.K)return null==a._omsData||!d&&a.getVisible()||this.unspiderfy(d?a:null),this.h()},c.getMarkers=function(){return this.a.slice(0)},c.removeMarker=function(a){return this.forgetMarker(a),a.setMap(null)},c.forgetMarker=function(a){var d,b,f,e,g;if(null!=a._omsData&&this.unspiderfy(),0>(d=this.A(this.a,a)))return this;for(b=0,f=(g=this.s.splice(d,1)[0]).length;b<f;b++)e=g[b],l.removeListener(e);return delete a._oms,this.a.splice(d,1),this.h(),this},c.removeAllMarkers=c.clearMarkers=function(){var a,d,f;for(f=this.getMarkers(),this.forgetAllMarkers(),a=0,d=f.length;a<d;a++)f[a].setMap(null);return this},c.forgetAllMarkers=function(){var a,d,b,f,e,g,c,q;for(this.unspiderfy(),a=d=0,b=(q=this.a).length;d<b;a=++d){for(g=q[a],c=0,a=(e=this.s[a]).length;c<a;c++)f=e[c],l.removeListener(f);delete g._oms}return this.C(),this},c.addListener=function(a,d){var b;return(null!=(b=this.c)[a]?b[a]:b[a]=[]).push(d),this},c.removeListener=function(a,d){var b;return 0>(b=this.A(this.c[a],d))||this.c[a].splice(b,1),this},c.clearListeners=function(a){return this.c[a]=[],this},c.trigger=function(){var a,d,b,f,e,g;for(d=arguments[0],a=2<=arguments.length?A.call(arguments,1):[],g=[],f=0,e=(d=null!=(b=this.c[d])?b:[]).length;f<e;f++)b=d[f],g.push(b.apply(null,a));return g},c.L=function(a,d){var b,f,e,g,c;for(g=this.circleFootSeparation*(2+a)/x,f=x/a,c=[],b=e=0;0<=a?e<a:e>a;b=0<=a?++e:--e)b=this.circleStartAngle+b*f,c.push(new h.Point(d.x+g*Math.cos(b),d.y+g*Math.sin(b)));return c},c.M=function(a,d){var b,f,e,c,k;for(c=this.spiralLengthStart,b=0,k=[],f=e=0;0<=a?e<a:e>a;f=0<=a?++e:--e)b+=this.spiralFootSeparation/c+5e-4*f,f=new h.Point(d.x+c*Math.cos(b),d.y+c*Math.sin(b)),c+=x*this.spiralLengthFactor/b,k.push(f);return k},c.V=function(a,d){var b,f,e,c,k,q,n,l,h;if((q=null!=a._omsData)&&this.keepSpiderfied||this.unspiderfy(),q||this.map.getStreetView().getVisible()||"GoogleEarthAPI"===this.map.getMapTypeId())return this.trigger("click",a,d);for(q=[],n=[],l=(b=this.nearbyDistance)*b,k=this.f(a.position),b=0,f=(h=this.a).length;b<f;b++)null!=(e=h[b]).map&&e.getVisible()&&(c=this.f(e.position),this.i(c,k)<l?q.push({R:e,G:c}):n.push(e));return 1===q.length?this.trigger("click",a,d):this.W(q,n)},c.markersNearMarker=function(a,d){var b,f,e,c,k,q,n,l,h,m;if(null==d&&(d=!1),null==this.g.getProjection())throw"Must wait for 'idle' event on map before calling markersNearMarker";for(n=(b=this.nearbyDistance)*b,k=this.f(a.position),q=[],b=0,f=(l=this.a).length;b<f&&!((e=l[b])!==a&&null!=e.map&&e.getVisible()&&(c=this.f(null!=(h=null!=(m=e._omsData)?m.v:void 0)?h:e.position),this.i(c,k)<n&&(q.push(e),d)));b++);return q},c.F=function(){var a,d,b,f,e,c,k,l,n,h,m,p;if(null==this.g.getProjection())throw"Must wait for 'idle' event on map before calling markersNearAnyOtherMarker";for(n=this.nearbyDistance,n*=n,p=[],h=0,d=(e=this.a).length;h<d;h++)f=e[h],p.push({H:this.f(null!=(a=null!=(b=f._omsData)?b.v:void 0)?a:f.position),b:!1});for(a=b=0,f=(h=this.a).length;b<f;a=++b)if(null!=(d=h[a]).getMap()&&d.getVisible()&&!(c=p[a]).b)for(d=l=0,e=(m=this.a).length;l<e;d=++l)if(k=m[d],d!==a&&null!=k.getMap()&&k.getVisible()&&(k=p[d],(!(d<a)||k.b)&&this.i(c.H,k.H)<n)){c.b=k.b=!0;break}return p},c.markersNearAnyOtherMarker=function(){var a,d,b,c,e,g,k;for(e=this.F(),k=[],a=d=0,b=(g=this.a).length;d<b;a=++d)c=g[a],e[a].b&&k.push(c);return k},c.setImmediate=function(a){return window.setTimeout(a,0)},c.h=function(){if(!this.basicFormatEvents&&null==this.l)return this.l=this.setImmediate((a=this,function(){return a.l=null,null!=a.g.getProjection()?a.w():null!=a.B?void 0:a.B=l.addListenerOnce(a.map,"idle",(function(){return a.w()}))}));var a},c.w=function(){var a,d,b,c,e,g,k;if(this.basicFormatEvents){for(e=[],d=0,b=markers.length;d<b;d++)a=null!=(c=markers[d])._omsData?"SPIDERFIED":"UNSPIDERFIED",e.push(this.trigger("format",c,this.constructor.markerStatus[a]));return e}for(e=this.F(),k=[],a=b=0,d=(g=this.a).length;b<d;a=++b)a=null!=(c=g[a])._omsData?"SPIDERFIED":e[a].b?"SPIDERFIABLE":"UNSPIDERFIABLE",k.push(this.trigger("format",c,this.constructor.markerStatus[a]));return k},c.P=function(a){return{m:(d=this,function(){return a._omsData.o.setOptions({strokeColor:d.legColors.highlighted[d.map.mapTypeId],zIndex:d.highlightedLegZIndex})}),u:function(d){return function(){return a._omsData.o.setOptions({strokeColor:d.legColors.usual[d.map.mapTypeId],zIndex:d.usualLegZIndex})}}(this)};var d},c.W=function(a,d){var b,c,e,g,k,q,n,m,p,r;return this.J=!0,r=a.length,b=this.T(function(){var b,d,c;for(c=[],b=0,d=a.length;b<d;b++)m=a[b],c.push(m.G);return c}()),g=r>=this.circleSpiralSwitchover?this.M(r,b).reverse():this.L(r,b),b=function(){var b,d,f;for(f=[],b=0,d=g.length;b<d;b++)e=g[b],c=this.U(e),p=this.S(a,function(a){return function(b){return a.i(b.G,e)}}(this)),n=p.R,q=new h.Polyline({map:this.map,path:[n.position,c],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,zIndex:this.usualLegZIndex}),n._omsData={v:n.getPosition(),X:n.getZIndex(),o:q},this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId]&&(k=this.P(n),n._omsData.O={m:l.addListener(n,"mouseover",k.m),u:l.addListener(n,"mouseout",k.u)}),this.trigger("format",n,this.constructor.markerStatus.SPIDERFIED),n.setPosition(c),n.setZIndex(Math.round(this.spiderfiedZIndex+e.y)),f.push(n);return f}.call(this),delete this.J,this.I=!0,this.trigger("spiderfy",b,d)},c.unspiderfy=function(a){var d,b,c,e,g,k,h;if(null==a&&(a=null),null==this.I)return this;for(this.K=!0,h=[],g=[],d=0,b=(k=this.a).length;d<b;d++)null!=(e=k[d])._omsData?(e._omsData.o.setMap(null),e!==a&&e.setPosition(e._omsData.v),e.setZIndex(e._omsData.X),null!=(c=e._omsData.O)&&(l.removeListener(c.m),l.removeListener(c.u)),delete e._omsData,e!==a&&(c=this.basicFormatEvents?"UNSPIDERFIED":"SPIDERFIABLE",this.trigger("format",e,this.constructor.markerStatus[c])),h.push(e)):g.push(e);return delete this.K,delete this.I,this.trigger("unspiderfy",h,g),this},c.i=function(a,d){var b,c;return(b=a.x-d.x)*b+(c=a.y-d.y)*c},c.T=function(a){var c,b,f,e,g;for(c=e=g=0,b=a.length;c<b;c++)e+=(f=a[c]).x,g+=f.y;return a=a.length,new h.Point(e/a,g/a)},c.f=function(a){return this.g.getProjection().fromLatLngToDivPixel(a)},c.U=function(a){return this.g.getProjection().fromDivPixelToLatLng(a)},c.S=function(a,c){var b,d,e,g,k,h;for(e=k=0,h=a.length;k<h;e=++k)g=c(g=a[e]),(null==b||g<d)&&(d=g,b=e);return a.splice(b,1)[0]},c.A=function(a,c){var b,d,e;if(null!=a.indexOf)return a.indexOf(c);for(b=d=0,e=a.length;d<e;b=++d)if(a[b]===c)return b;return-1},r}(),t=/(\?.*(&|&amp;)|\?)spiderfier_callback=(\w+)/,null==(m=document.currentScript)&&(m=function(){var m,l,h,w,v;for(v=[],m=0,l=(h=document.getElementsByTagName("script")).length;m<l;m++)null!=(w=(u=h[m]).getAttribute("src"))&&w.match(t)&&v.push(u);return v}()[0]),null!=m&&(m=null!=(w=m.getAttribute("src"))&&null!=(y=w.match(t))?y[3]:void 0)&&"function"==typeof window[m]&&window[m](),"function"==typeof window.spiderfier_callback&&window.spiderfier_callback()}).call(this);